<!DOCTYPE html>
<html>
<head>
   <title>Nodes &gt; Output &gt; WhatsApp</title>
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta name="description" content="Purpose &nbsp;This node is used to send WhatsApp notifications. Note: Before using this node you will need to have a Meta Developers Account and get two pieces of information from" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <link type="text/css" href="custom.css" rel="stylesheet" />

   <style TYPE="text/css" media="screen"> 
      html, body { margin:0; 
        padding:0; 
        background: #ffffff; 
      } 
      div#printheader { display: none; }
      #idheader { 
        width:100%; 
        height:auto; 
        padding: 0; 
        margin: 0;
        position: fixed;
        top: 0;
        z-index: 2;
      } 
      /* The "min-height" for "#idheader table" ensures that the (blue) header of the topic
         has at least the same height as the header of the navigation panel left of it */
      #idheader table { background: #404040; min-height: 59px }             
      #idheader h1 span { color: #FFF }     
      #idnav {
        text-align: right;
        width: 126px;
        vertical-align: middle;        
      } 
      #idnav a { text-decoration: none }
      #idnav span {
        display: inline-block;
        width: 24px;
        height: 24px;
        margin-left: 4px;
        background:url('hm_webhelp_buttons_grey.png') top left no-repeat;
      } 
      #idnav a span {
        background-image:url('hm_webhelp_buttons_white.png');
      } 
      #idnav a span:hover {
        background-image:url('hm_webhelp_buttons_yellow.png');
      } 
      #idnav span.hmbtnprev { background-position: 0 -32px }
      #idnav span.hmbtnnext { background-position: -24px -32px }
      #idnav span.hmbtntop  { background-position: -48px -32px }
      #idnav span.hmbtntoggle  { width: 20px; background-position: -70px -32px }
      #idnav span.hmbtnprint  { background-position: -88px -32px }

      #callout-table, #overview-table {display:block; position:relative; top:0; left:0;}
      #callout-icon {display:block; position:absolute; top:-11px; left:-11px;}
      #callout-icon-flag {display:block; position:absolute; top:-11px; left:-8px;}
      #callout-table a {text-decoration: none; color: blue;}
      #callout-table a:visited {text-decoration: none; color: blue;}
      #overview-table a {text-decoration: none; color: black;}
      #overview-table a:visited {text-decoration: none; color: black;}
      #callout-table a:hover, #overview-table a:hover {text-decoration: underline;}       
      p.help-url { margin: 20px 0 5px 0; text-align: center; font-size: 80%; text-decoration: none }      
      #switchtoggles { text-align: right; padding: 0 2px 0 0; font-size: 90%; } 
      .sync-toc { color: #FFF; font-size: 8pt; font-weight: bold; display: none; }
      .sync-toc a { color: #FFF; text-decoration: none; font-weight: bold;}
      .sync-toc a:visited { color: #FFF; }
      .sync-toc a:hover { text-decoration: underline; }
      a.hmanchor { display: inline-block; margin-top: -4em; padding-top: 4em }	  
   </style>
   <style TYPE="text/css" media="print">
      div#idheader, img.dropdown-toggle-icon, p.help-url { display:none } 
   </style>
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "whatsapp.html");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<div id="printheader"><h1 class="p_Heading1" style="page-break-after: avoid;"><span class="f_Heading1">WhatsApp</span></h1>
</div>
<div id="idheader">
<div id="idheaderbg">
<table style="width:100%;border:none;margin:0px;" cellspacing="0" cellpadding="0"> 
  <tr>
    <td class="topichead" style="text-align:left; vertical-align:bottom">
      <p class="sync-toc">&lt;&lt; <a rel="nofollow" href="index.html?whatsapp.html" target="_top">Click to Display Table of Contents</a> &gt;&gt;</p>
      <p class="crumbs"><b>Navigation:</b>&nbsp;
      
      <a href="nodes.html">Nodes</a> &gt; <a href="output.html">Output</a>&nbsp;&gt;</p>
   
      <h1 class="p_Heading1" style="page-break-after: avoid;"><span class="f_Heading1">WhatsApp</span></h1>

    </td>
    <td class="topichead" id="idnav">
      
      <a href="youtube.html" title="Previous Topic"><span class="hmbtnprev"></span></a>
      <a href="output.html" title="Parent Chapter"><span class="hmbtntop"></span></a>
      <a href="python-scripting-tools-in-mist.html" title="Next Topic"><span class="hmbtnnext"></span></a>
      
    </td>
  </tr>  
</table>
</div>
</div>  

<div id="idcontent"><div id="innerdiv">
<!-- Ask Internet Explorer 6.users to update their obsolete and dangerous browser --> 
<!--[if lt IE 7]><div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;'><a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode"><img src="http://storage.ie6countdown.com/assets/100/images/banners/warning_bar_0000_us.jpg" border="0" height="42" width="820" alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today." /></a></div><![endif]-->

<!--ZOOMRESTART-->
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">&nbsp;</span></h2>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">Purpose</span></h2>
<p class="p_Normal">&nbsp;</p>
<p class="p_BodyText"><span class="f_BodyText">This node is used to send WhatsApp notifications.</span></p>
<p class="p_Normal">Note: Before using this node you will need to have a <span class="f_T_Menu">Meta Developers Account </span>and get two pieces of information from it: &nbsp;the <span class="f_T_Menu">Phone Number ID</span> and the <span class="f_T_Menu">Access Token</span>., and also have the sender and receiver numbers approved. The process to configure all that is introduced in a tutorial at the end of this page.</p>
<p class="p_Normal">&nbsp;</p>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">Inputs</span></h2>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal"><span class="f_Heading3">files:</span> <span class="f_BodyText">Files to be mentioned in the WhatsApp notification</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal"><img alt="whatasppWF" width="832" height="479" style="margin:0;width:832px;height:479px;border:none" src="whatasppwf.png"/></p>
<p class="p_Normal">&nbsp;</p>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">Standard properties</span></h2>
<p class="p_Normal">&nbsp;</p>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3">Object Properties</span></h3>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3"><a href="common-parameters.html#objectname" class="topiclink" title="Object Name">Object Name</a></span></h3>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3"><a href="common-parameters.html#color" class="topiclink" title="Color">Color</a></span></h3>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3"><a href="common-parameters.html#bypassenabled" class="topiclink" title="Color">Bypass</a></span></h3>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3"><a href="common-parameters.html#lock" class="topiclink">Lock</a></span></h3>
<p class="p_Normal">&nbsp;</p>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3">&nbsp;</span></h3>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">Node specific properties</span></h2>
<p class="p_Normal">&nbsp;</p>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3">Only send if Input:  </span><span class="f_BodyText">Do not send notifications when the workflow execution results on an empty input.</span></h3>
<p class="p_Normal">&nbsp;</p>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3">Phone Nr Id:  </span><span class="f_BodyText">This is the </span><span class="f_T_Menu">Phone number ID</span><span class="f_BodyText"> from the WhatsApp API in your Meta Developers account (note that you need to put the </span><span class="f_T_Menu">Phone Number ID</span><span class="f_BodyText">, </span><span class="f_TipHeading">not the phone number itself</span><span class="f_BodyText">)</span></h3>
<p class="p_Normal">&nbsp;</p>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3">Access Token:  </span><span class="f_BodyText">Access token from the WhatsApp API in your Meta Developers account</span></h3>
<p class="p_Normal">&nbsp;</p>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3">Message to:  </span><span class="f_BodyText">Phone number for the recipient, starting with the country code (for example, +44 6666666666). Spaces are optional.</span></h3>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3">&nbsp;</span></h3>
<h3 class="p_Heading3" style="page-break-after: avoid;"><span class="f_Heading3">Body:  </span><span class="f_BodyText">Message content. Example code is provided to include the list of input files in your message.</span></h3>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal"><span style="font-family: 'Times New Roman',Times,Georgia,serif; color: #000000;">Put your text here...</span></p>
<p class="p_Normal"><span style="font-family: 'Times New Roman',Times,Georgia,serif; color: #000000;">List of Input Files:</span></p>
<p class="p_Normal"><span style="font-family: 'Times New Roman',Times,Georgia,serif; color: #000000;">&lt;?py</span></p>
<p class="p_Normal"><span style="font-family: 'Times New Roman',Times,Georgia,serif; color: #000000;">for c in self.getConnectors():</span></p>
<p class="p_Normal"><span style="font-family: 'Times New Roman',Times,Georgia,serif; color: #000000;">for p in c.getUniversalPaths():</span></p>
<p class="p_Normal"><span style="font-family: 'Times New Roman',Times,Georgia,serif; color: #000000;">print (p.toString())</span></p>
<p class="p_Normal"><span style="font-family: 'Times New Roman',Times,Georgia,serif; color: #000000;">?&gt;</span></p>
<p class="p_Normal">&nbsp;</p>
<h2 class="p_Heading2" style="page-break-after: avoid;"><span class="f_Heading2">Configuration instructions and basic tutorial.</span></h2>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Before using this node, you need to have a Meta Developers account ready to use. &nbsp;We will need two essential pieces of information from it: the <span class="f_T_Menu">Phone Number ID</span> and the <span class="f_T_Menu">Access Token</span>, and you will also need to add and approve the phone numbers that will send and receive the messages. The following steps explain how to do just that. </p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">In principle it is an easy process (and free of cost) to get it working, at least with a test number that the Meta Developers website will provide to you (this intro only covers in detail the basic usage, for more advanced services please follow instructions from the Meta developers web site).</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">First thing, navigate to the <a href="https://developers.facebook.com/?no_redirect=1" target="_blank" class="weblink">Meta Developer website</a> and log in with your usual user account. Then follow instructions and create a &quot;developers account&quot; (If you do not have it yet).</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Note: The instructions below correspond to the Meta developers website as it was at the creation of this document. But these type of websites change often, so you may need to adapt the instructions below.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Once you have your developers account, go to the &quot;All Apps&quot; section and proceed to &quot;Create App&quot;. Select the &quot;Other&quot; option and choose a Business type app. , and select the option to integrate &nbsp;with the <span class="f_T_Menu">WhatsApp</span> product. &nbsp;You can name your new App as you wish, but for clarity we recommend to call it &quot;Mistika Workflows&quot; (you can create other Apps for other type of usage...)</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Continue entering your account information to create your portfolio. Please note that it is important to use an available business domain (although it is not necessary for basic testing as in this tutorial). </p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Note: During all these processes you will be asked to verify the phone numbers that you will use to send and receive notifications (just follow instructions when requested to do so...), and also your email.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Now, in the <span class="f_T_Menu">WhatsApp -&gt; API setup</span> section:</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Here, you will find your temporal<span class="f_T_Menu"> Access Token</span>, (which is valid for 24 hours only), along with the  <span class="f_T_Menu">Phone number ID</span>, which is associated to the phone number from which you will send notifications (in principle we are going a test number provided by Meta. Later you can add your own sender numbers later and also permanent access tokens, but that is not covered by this tutorial). &nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Note that there can be several IDs and phone numbers in that section and it is easy to be confused, but the only &quot;<span class="f_T_Menu">ID</span>&quot; you need to input in the WhatsApp node of Mistika Workflows is the one labeled as <span class="f_T_Menu">Phone number ID  </span>(that is, not the phone number, but its <span class="f_T_Menu">ID</span>...).</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">In this basic example we are going to use the test number assigned to you by Meta as the sender phone, as we just want to test that the WhatsApp node can connect to your account and send messages from that number.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Click on &quot;Generate Access Token&quot;. Simply copy it, and paste it into the <span class="f_T_Menu">Access Token </span>property of the <span class="f_T_Menu">WhatsApp</span> node within Mistika Workflows.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">In the next section of the website you will find a <span class="f_T_Menu" style="font-size: 13px;">Send message</span> button for testing purposes. &nbsp;To be able to use it, select the test phone (as sender), then select  <span class="f_T_Menu">recipient phone number -&gt; Manage phone number list </span> and add a recipient phone to the list (if not yet). For example you can put your personal phone in there to receive test messages. &nbsp;And now the <span class="f_T_Menu" style="font-size: 13px;">Send message </span>button should be ready to use.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal"><img alt="whatasppweb" width="904" height="1193" style="margin:0;width:904px;height:1193px;border:none" src="whatasppweb.png"/></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Note that Meta will &nbsp;follow the usual anti spam procedures, so you will need to have a person with the recipient phone confirming codes as requested, and sending a first answer to the first message received from a new number (as usual on WhatsApp)</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">In the <span class="f_T_Menu">Step 2 </span>of the web page, check that the <span class="f_T_Menu" style="font-size: 13px;">Send message</span> button is sending WhatsApp messages (it should work as fast as normal messages). &nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">If the <span class="f_T_Menu" style="font-size: 13px;">Send message</span> button is not active, &nbsp;check that you have selected the test number (sender), a valid recipient number, and that you have an active Access Token (or click on <span class="f_T_Menu">Generate Access token </span>again if it is empty, which can happen between sessions).</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Do not try using the <span class="f_T_Menu">WhatsApp</span> node within &nbsp;Mistika Workflows until the above tests are fully working (If the Meta official test is not working then Mistika Workflows will neither work, and you don't want to be considered a spammer by sending repeated unauthorized messages from an external application...)</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Once the above test is working, &nbsp;go to Mistika Workflows and test the WhatsApp node (filled with the credentials explained above) and setup a simple task, for example just connect one media file to it and execute the workflow in the queue.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Note: If the workflow execution does not send any message (but it works in the Meta Developer website) and it does not output any &nbsp;errors in the render log panel then it means the message was successfully sent, but the recipient account is still blocking the sender &nbsp;(the approval process was not completed). &nbsp;An easy way to complete the approval is to send a message &nbsp;(the <span class="f_T_Menu" style="font-size: 13px;">Send message </span>button in your Meta Developers account) and then answering something (any text) from the recipient phone. From that point the sender number will be approved by the recipient, so it should also work from external applications such as Mistika Workflows.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Now you can continue with <span class="f_T_Menu">Step 3</span> and further steps in the developers web page. </p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Finally, just to introduce typical next steps (but use the Meta documentation for more details): &nbsp;You will probably want to generate a <span class="f_T_Menu">Permanent Access Token</span>, and you will probably want to use your own sender numbers. For that you will need to navigate to your Facebook account's business settings, then access &quot;Users&quot; followed by &quot;System users&quot;. If you haven't created a system user yet, click on &quot;Add&quot; to create one. Ensure to provide a name and set the system user role as admin, then proceed by clicking on &quot;Create System User&quot;, and setup permissions policies as needed for your case (please ask Meta/Facebook support in case of doubts, as this is out of the scope of this tutorial...). &nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">And as in the previous example <span class="f_TipHeading">do not try to send messages from new numbers with Mistika Workflows until they are working with the official test in the Meta Developers account and they have passed the approval requests</span>.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>

<!--ZOOMSTOP-->
</div></div>
<script type="text/javascript">


  $(document).ready(function(){
    $(window).bind('resize', function() {
      var y = $('#idheader').height(); 
      $('#idcontent').css('margin-top', y);
      var par = window.parent;
      if ($( par ).width() <= $( window ).width()+20) {
        $('#idheader').css('position', 'relative');
        $('#idcontent').css('margin-top', 0);
        $('#idbacktotop').css('display', 'block');
        $('.hmanchor').css('margin-top', -20);
	$('.hmanchor').css('padding-top', 20);
      }
      else {
        $('#idheader').css('position', 'fixed');
        $('#idcontent').css('margin-top', $('#idheader').height());
        $('#idbacktotop').css('display', 'none');
        $('.hmanchor').css('margin-top', -y-20);
	$('.hmanchor').css('padding-top', y+20);
      }
    });
    
    $(window).resize(); //trigger event for initially small displays
  });

if ((!parent.hmNavigationFrame) && (parent.location) && (parent.location.href)) { $('.sync-toc').show();$('p.crumbs').hide();}

</script>
</body>
</html>
